{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chalanthornaenguthaivadt/Desktop/Thesis/Gold-Inventory-Management-System/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/chalanthornaenguthaivadt/Desktop/Thesis/Gold-Inventory-Management-System/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/chalanthornaenguthaivadt/Desktop/Thesis/Gold-Inventory-Management-System/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import'./signinpage.css';import{useCookies}from'react-cookie';import{useLoading}from'../../contexts/LoadingContext';import{useAlert}from'../../contexts/AlertContext';import SigninClick from'../../functions/Signin';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SignInPage(){var navigate=useNavigate();var _useCookies=useCookies(['access-token']),_useCookies2=_slicedToArray(_useCookies,2),setCookie=_useCookies2[1];var _useLoading=useLoading(),setLoading=_useLoading.setLoading;var _useAlert=useAlert(),setAlert=_useAlert.setAlert;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),userID=_useState2[0],setUserID=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),userPasswd=_useState4[0],setUserPasswd=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showInvalid=_useState6[0],setShowInvalid=_useState6[1];useEffect(function(){setShowInvalid(false);},[userID,userPasswd]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var signin;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setLoading(true);_context.next=4;return SigninClick(userID,userPasswd);case 4:signin=_context.sent;if(signin.res){setShowInvalid(false);setCookie('access-token',signin.token,{expires:new Date(Date.now()+86400000*2)});if(signin.role==='employee'){navigate('/checking');}else{navigate('/inventory');}}else{setShowInvalid(true);setAlert({active:true,message:'invalid username or password'});}setLoading(false);case 7:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"background\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-signin\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-signin\",children:\"sign in\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{className:\"input-userid\",type:\"text\",placeholder:\"Username\",onChange:function onChange(e){return setUserID(e.target.value);}}),/*#__PURE__*/_jsx(\"input\",{className:\"input-passwd\",type:\"password\",placeholder:\"Password\",onChange:function onChange(e){return setUserPasswd(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"input-incorrect \".concat(showInvalid?'show':''),children:userID===''||userPasswd===''?'please enter username and password':'invalid username or password'}),/*#__PURE__*/_jsx(\"button\",{className:\"button-signin\",type:\"submit\",children:\"sign in\"})]})]})});}export default SignInPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useCookies","useLoading","useAlert","SigninClick","SignInPage","navigate","setCookie","setLoading","setAlert","userID","setUserID","userPasswd","setUserPasswd","showInvalid","setShowInvalid","handleSubmit","e","preventDefault","signin","res","token","expires","Date","now","role","active","message","target","value"],"sources":["/Users/chalanthornaenguthaivadt/Desktop/Thesis/Gold-Inventory-Management-System/src/pages/signin/SignInPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './signinpage.css';\nimport { useCookies } from 'react-cookie';\n\nimport { useLoading } from '../../contexts/LoadingContext';\nimport { useAlert } from '../../contexts/AlertContext';\n\nimport SigninClick from '../../functions/Signin';\n\nfunction SignInPage() {\n  const navigate = useNavigate();\n\n  const [, setCookie] = useCookies(['access-token']);\n\n  const { setLoading } = useLoading();\n  const { setAlert } = useAlert();\n\n  const [userID, setUserID] = useState<string>('');\n  const [userPasswd, setUserPasswd] = useState<string>('');\n\n  const [showInvalid, setShowInvalid] = useState<boolean>(false);\n\n  useEffect(() => {\n    setShowInvalid(false);\n  }, [userID, userPasswd]);\n\n  const handleSubmit = async (e: any) => {\n    e.preventDefault();\n    setLoading(true);\n    const signin = await SigninClick(userID, userPasswd);\n    if (signin.res) {\n      setShowInvalid(false);\n      setCookie('access-token', signin.token, { expires: new Date(Date.now() + 86400000 * 2) });\n      if (signin.role === 'employee') {\n        navigate('/checking');\n      } else {\n        navigate('/inventory');\n      }\n    } else {\n      setShowInvalid(true);\n      setAlert({\n        active: true,\n        message: 'invalid username or password'\n      });\n    }\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"background\">\n      <div className=\"container-signin\">\n        <div className=\"header-signin\">sign in</div>\n        <form onSubmit={handleSubmit}>\n          <input\n            className=\"input-userid\"\n            type=\"text\"\n            placeholder=\"Username\"\n            onChange={(e) => setUserID(e.target.value)}\n          />\n          <input\n            className=\"input-passwd\"\n            type=\"password\"\n            placeholder=\"Password\"\n            onChange={(e) => setUserPasswd(e.target.value)}\n          />\n          {/* <a className=\"link-forgotpass\" href=\"/\">forgot password?</a> */}\n          <div className={`input-incorrect ${showInvalid ? 'show' : ''}`}>\n            {\n              userID === '' || userPasswd === ''\n                ? 'please enter username and password'\n                : 'invalid username or password'\n            }\n          </div>\n          <button\n            className=\"button-signin\"\n            type=\"submit\"\n          >\n            sign in\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default SignInPage;\n"],"mappings":"+fAAA,MAAOA,MAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,kBAAkB,CACzB,OAASC,UAAU,KAAQ,cAAc,CAEzC,OAASC,UAAU,KAAQ,+BAA+B,CAC1D,OAASC,QAAQ,KAAQ,6BAA6B,CAEtD,MAAOC,YAAW,KAAM,wBAAwB,CAAC,wFAEjD,QAASC,WAAU,EAAG,CACpB,GAAMC,SAAQ,CAAGN,WAAW,EAAE,CAE9B,gBAAsBC,UAAU,CAAC,CAAC,cAAc,CAAC,CAAC,4CAAzCM,SAAS,iBAElB,gBAAuBL,UAAU,EAAE,CAA3BM,UAAU,aAAVA,UAAU,CAClB,cAAqBL,QAAQ,EAAE,CAAvBM,QAAQ,WAARA,QAAQ,CAEhB,cAA4BX,QAAQ,CAAS,EAAE,CAAC,wCAAzCY,MAAM,eAAEC,SAAS,eACxB,eAAoCb,QAAQ,CAAS,EAAE,CAAC,yCAAjDc,UAAU,eAAEC,aAAa,eAEhC,eAAsCf,QAAQ,CAAU,KAAK,CAAC,yCAAvDgB,WAAW,eAAEC,cAAc,eAElChB,SAAS,CAAC,UAAM,CACdgB,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAAE,CAACL,MAAM,CAAEE,UAAU,CAAC,CAAC,CAExB,GAAMI,aAAY,4FAAG,iBAAOC,CAAM,+HAChCA,CAAC,CAACC,cAAc,EAAE,CAClBV,UAAU,CAAC,IAAI,CAAC,CAAC,sBACIJ,YAAW,CAACM,MAAM,CAAEE,UAAU,CAAC,QAA9CO,MAAM,eACZ,GAAIA,MAAM,CAACC,GAAG,CAAE,CACdL,cAAc,CAAC,KAAK,CAAC,CACrBR,SAAS,CAAC,cAAc,CAAEY,MAAM,CAACE,KAAK,CAAE,CAAEC,OAAO,CAAE,GAAIC,KAAI,CAACA,IAAI,CAACC,GAAG,EAAE,CAAG,QAAQ,CAAG,CAAC,CAAE,CAAC,CAAC,CACzF,GAAIL,MAAM,CAACM,IAAI,GAAK,UAAU,CAAE,CAC9BnB,QAAQ,CAAC,WAAW,CAAC,CACvB,CAAC,IAAM,CACLA,QAAQ,CAAC,YAAY,CAAC,CACxB,CACF,CAAC,IAAM,CACLS,cAAc,CAAC,IAAI,CAAC,CACpBN,QAAQ,CAAC,CACPiB,MAAM,CAAE,IAAI,CACZC,OAAO,CAAE,8BACX,CAAC,CAAC,CACJ,CACAnB,UAAU,CAAC,KAAK,CAAC,CAAC,sDACnB,kBApBKQ,aAAY,4CAoBjB,CAED,mBACE,YAAK,SAAS,CAAC,YAAY,uBACzB,aAAK,SAAS,CAAC,kBAAkB,wBAC/B,YAAK,SAAS,CAAC,eAAe,qBAAc,cAC5C,cAAM,QAAQ,CAAEA,YAAa,wBAC3B,cACE,SAAS,CAAC,cAAc,CACxB,IAAI,CAAC,MAAM,CACX,WAAW,CAAC,UAAU,CACtB,QAAQ,CAAE,kBAACC,CAAC,QAAKN,UAAS,CAACM,CAAC,CAACW,MAAM,CAACC,KAAK,CAAC,EAAC,EAC3C,cACF,cACE,SAAS,CAAC,cAAc,CACxB,IAAI,CAAC,UAAU,CACf,WAAW,CAAC,UAAU,CACtB,QAAQ,CAAE,kBAACZ,CAAC,QAAKJ,cAAa,CAACI,CAAC,CAACW,MAAM,CAACC,KAAK,CAAC,EAAC,EAC/C,cAEF,YAAK,SAAS,2BAAqBf,WAAW,CAAG,MAAM,CAAG,EAAE,CAAG,UAE3DJ,MAAM,GAAK,EAAE,EAAIE,UAAU,GAAK,EAAE,CAC9B,oCAAoC,CACpC,8BAA8B,EAEhC,cACN,eACE,SAAS,CAAC,eAAe,CACzB,IAAI,CAAC,QAAQ,qBAGN,GACJ,GACH,EACF,CAEV,CAEA,cAAeP,WAAU"},"metadata":{},"sourceType":"module"}