{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chalanthornaenguthaivadt/Desktop/final_thesis/gims/gims-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/chalanthornaenguthaivadt/Desktop/final_thesis/gims/gims-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/chalanthornaenguthaivadt/Desktop/final_thesis/gims/gims-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import'./buytransactionpage.css';import{useNavigate}from'react-router-dom';import{useCookies}from'react-cookie';import{useLoading}from'../../contexts/LoadingContext';import{useConfirm}from'../../contexts/ConfirmContext';import{useAlert}from'../../contexts/AlertContext';import{CheckWeight}from'../../functions/ConvertWeight';import{BuyTransaction}from'../../functions/CreateTransaction';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function BuyTransactionPage(){var navigate=useNavigate();var _useCookies=useCookies(['access-token']),_useCookies2=_slicedToArray(_useCookies,1),cookies=_useCookies2[0];var _useLoading=useLoading(),setLoading=_useLoading.setLoading;var _useConfirm=useConfirm(),confirm=_useConfirm.confirm,setConfirm=_useConfirm.setConfirm;var _useAlert=useAlert(),setAlert=_useAlert.setAlert;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),goldPriceStart=_useState2[0],setGoldPriceStart=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),goldPriceEnd=_useState4[0],setGoldPriceEnd=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),weight=_useState6[0],setWeight=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),price=_useState8[0],setPrice=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),note=_useState10[0],setNote=_useState10[1];var _useState11=useState('gram'),_useState12=_slicedToArray(_useState11,2),weightUnit=_useState12[0],setWeightUnit=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),submit=_useState14[0],isSubmit=_useState14[1];function CheckFillAll(){if(goldPriceStart===0||goldPriceEnd===0||weight===0||price===0){return false;}return true;}var buy=function buy(e){e.preventDefault();isSubmit(true);if(CheckFillAll()){setConfirm({active:true,message:'confirm save ?',action:'buytransaction',status:''});}};function Buy(){return _Buy.apply(this,arguments);}function _Buy(){_Buy=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var buyResult;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.next=3;return BuyTransaction(\"\".concat(goldPriceStart,\" - \").concat(goldPriceEnd),CheckWeight(weight,weightUnit),price,note,cookies['access-token']);case 3:buyResult=_context.sent;if(buyResult==='complete'){navigate('/transaction');}else{setAlert({active:true,message:'Error! can not create transaction.\\ntry agian later.'});}setLoading(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return _Buy.apply(this,arguments);}useEffect(function(){if(confirm.status==='confirm'&&confirm.action==='buytransaction'){Buy();setConfirm({active:false,message:'',action:'',status:''});}},[confirm.status]);return/*#__PURE__*/_jsxs(\"div\",{className:\"buy-transaction page-background\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"buy-transaction page-header\",children:\"buy\"}),/*#__PURE__*/_jsx(\"div\",{className:\"buy-transaction page-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"buy-transaction page-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"buy-transaction page-content-header\",children:\"transaction detail\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:buy,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-comp\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-label\",children:[\"gold price\",/*#__PURE__*/_jsx(\"span\",{className:\"\\n                    important-mark\\n                    \".concat(CheckFillAll()||goldPriceStart!==0||goldPriceEnd!==0?'':'show',\"\\n                  \"),children:\"*\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"gold-price\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"inputbox\",onChange:function onChange(e){setGoldPriceStart(e.target.valueAsNumber);}}),/*#__PURE__*/_jsx(\"span\",{className:\"gold-price-range\",children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"inputbox\",onChange:function onChange(e){setGoldPriceEnd(e.target.valueAsNumber);}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-comp\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-label\",children:[\"weight\",/*#__PURE__*/_jsx(\"span\",{className:\"important-mark \".concat(CheckFillAll()||weight!==0?'':'show'),children:\"*\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"buy-transaction input-weight\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.00000001\",className:\"inputbox\",onChange:function onChange(e){setWeight(e.target.valueAsNumber);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"select-weightUnit\",children:[/*#__PURE__*/_jsxs(\"select\",{onChange:function onChange(e){setWeightUnit(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"gram\",children:\"gram\"}),/*#__PURE__*/_jsx(\"option\",{value:\"baht\",children:\"baht\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"custom-arrow\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-comp\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-label\",children:[\"price\",/*#__PURE__*/_jsx(\"span\",{className:\"important-mark \".concat(CheckFillAll()||price!==0?'':'show'),children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.001\",className:\"inputbox\",onChange:function onChange(e){setPrice(e.target.valueAsNumber);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-comp\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-label\",children:\"note\"}),/*#__PURE__*/_jsx(\"textarea\",{rows:4,className:\"inputbox note\",onChange:function onChange(e){setNote(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"invalid-fillall-message \".concat(CheckFillAll()||!submit?'':'show'),children:\"please fill all details\"}),/*#__PURE__*/_jsx(\"input\",{className:\"buy-transaction button-save\",type:\"submit\",value:\"confirm\"})]})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useCookies","useLoading","useConfirm","useAlert","CheckWeight","BuyTransaction","BuyTransactionPage","navigate","cookies","setLoading","confirm","setConfirm","setAlert","goldPriceStart","setGoldPriceStart","goldPriceEnd","setGoldPriceEnd","weight","setWeight","price","setPrice","note","setNote","weightUnit","setWeightUnit","submit","isSubmit","CheckFillAll","buy","e","preventDefault","active","message","action","status","Buy","buyResult","target","valueAsNumber","value"],"sources":["/Users/chalanthornaenguthaivadt/Desktop/final_thesis/gims/gims-frontend/src/pages/buytransactionpage/BuyTransactionPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './buytransactionpage.css';\nimport { useNavigate } from 'react-router-dom';\nimport { useCookies } from 'react-cookie';\n\nimport { useLoading } from '../../contexts/LoadingContext';\nimport { useConfirm } from '../../contexts/ConfirmContext';\nimport { useAlert } from '../../contexts/AlertContext';\n\nimport { CheckWeight } from '../../functions/ConvertWeight';\nimport { BuyTransaction } from '../../functions/CreateTransaction';\n\nexport default function BuyTransactionPage() {\n  const navigate = useNavigate();\n  const [cookies] = useCookies(['access-token']);\n\n  const { setLoading } = useLoading();\n  const { confirm, setConfirm } = useConfirm();\n  const { setAlert } = useAlert();\n\n  const [goldPriceStart, setGoldPriceStart] = useState<number>(0);\n  const [goldPriceEnd, setGoldPriceEnd] = useState<number>(0);\n  const [weight, setWeight] = useState<number>(0);\n  const [price, setPrice] = useState<number>(0);\n  const [note, setNote] = useState<string>('');\n\n  const [weightUnit, setWeightUnit] = useState<string>('gram');\n\n  const [submit, isSubmit] = useState<boolean>(false);\n\n  function CheckFillAll() {\n    if (\n      goldPriceStart === 0\n      || goldPriceEnd === 0\n      || weight === 0\n      || price === 0\n    ) {\n      return false;\n    }\n    return true;\n  }\n\n  const buy = (e: any) => {\n    e.preventDefault();\n    isSubmit(true);\n    if (CheckFillAll()) {\n      setConfirm({\n        active: true,\n        message: 'confirm save ?',\n        action: 'buytransaction',\n        status: ''\n      });\n    }\n  };\n\n  async function Buy() {\n    setLoading(true);\n    const buyResult = await BuyTransaction(\n      `${goldPriceStart} - ${goldPriceEnd}`,\n      CheckWeight(weight, weightUnit),\n      price,\n      note,\n      cookies['access-token']\n    );\n    if (buyResult === 'complete') {\n      navigate('/transaction');\n    } else {\n      setAlert({\n        active: true,\n        message: 'Error! can not create transaction.\\ntry agian later.'\n      });\n    }\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    if (confirm.status === 'confirm' && confirm.action === 'buytransaction') {\n      Buy();\n      setConfirm({\n        active: false,\n        message: '',\n        action: '',\n        status: ''\n      });\n    }\n  }, [confirm.status]);\n\n  return (\n    <div className=\"buy-transaction page-background\">\n      {/* Page Header */}\n      <div className=\"buy-transaction page-header\">\n        buy\n      </div>\n      {/* Page Content */}\n      <div className=\"buy-transaction page-container\">\n        <div className=\"buy-transaction page-content\">\n          {/* Content Header */}\n          <div className=\"buy-transaction page-content-header\">\n            transaction detail\n          </div>\n          {/* Form Buy Transaction */}\n          <form onSubmit={buy}>\n            {/* Input Gold Price */}\n            <div className=\"input-comp\">\n              <div className=\"input-label\">\n                gold price\n                <span\n                  className={`\n                    important-mark\n                    ${CheckFillAll()\n                      || goldPriceStart !== 0\n                      || goldPriceEnd !== 0\n                    ? '' : 'show'\n                    }\n                  `}\n                >\n                  *\n                </span>\n              </div>\n              <div className=\"gold-price\">\n                <input\n                  type=\"number\"\n                  className=\"inputbox\"\n                  onChange={(e) => { setGoldPriceStart(e.target.valueAsNumber); }}\n                />\n                <span className=\"gold-price-range\">-</span>\n                <input\n                  type=\"number\"\n                  className=\"inputbox\"\n                  onChange={(e) => { setGoldPriceEnd(e.target.valueAsNumber); }}\n                />\n              </div>\n            </div>\n            {/* Input Weight */}\n            <div className=\"input-comp\">\n              <div className=\"input-label\">\n                weight\n                <span className={`important-mark ${CheckFillAll() || weight !== 0 ? '' : 'show'}`}>\n                  *\n                </span>\n              </div>\n              <div className=\"buy-transaction input-weight\">\n                <input\n                  type=\"number\"\n                  step=\"0.00000001\"\n                  className=\"inputbox\"\n                  onChange={(e) => { setWeight(e.target.valueAsNumber); }}\n                />\n                <div className=\"select-weightUnit\">\n                  <select\n                    onChange={(e) => { setWeightUnit(e.target.value); }}\n                  >\n                    <option value=\"gram\">gram</option>\n                    <option value=\"baht\">baht</option>\n                  </select>\n                  <span className=\"custom-arrow\" />\n                </div>\n              </div>\n            </div>\n            {/* Input Price */}\n            <div className=\"input-comp\">\n              <div className=\"input-label\">\n                price\n                <span className={`important-mark ${CheckFillAll() || price !== 0 ? '' : 'show'}`}>\n                  *\n                </span>\n              </div>\n              <input\n                type=\"number\"\n                step=\"0.001\"\n                className=\"inputbox\"\n                onChange={(e) => { setPrice(e.target.valueAsNumber); }}\n              />\n            </div>\n            {/* Input Note */}\n            <div className=\"input-comp\">\n              <div className=\"input-label\">note</div>\n              <textarea\n                rows={4}\n                className=\"inputbox note\"\n                onChange={(e) => { setNote(e.target.value); }}\n              />\n            </div>\n            {/* Alert Fill All */}\n            <div className={`invalid-fillall-message ${CheckFillAll() || !submit ? '' : 'show'}`}>\n              please fill all details\n            </div>\n            {/* Confirm Button */}\n            <input\n              className=\"buy-transaction button-save\"\n              type=\"submit\"\n              value=\"confirm\"\n            />\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"ueAAA,MAAOA,MAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,0BAA0B,CACjC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,UAAU,KAAQ,cAAc,CAEzC,OAASC,UAAU,KAAQ,+BAA+B,CAC1D,OAASC,UAAU,KAAQ,+BAA+B,CAC1D,OAASC,QAAQ,KAAQ,6BAA6B,CAEtD,OAASC,WAAW,KAAQ,+BAA+B,CAC3D,OAASC,cAAc,KAAQ,mCAAmC,CAAC,wFAEnE,cAAe,SAASC,mBAAkB,EAAG,CAC3C,GAAMC,SAAQ,CAAGR,WAAW,EAAE,CAC9B,gBAAkBC,UAAU,CAAC,CAAC,cAAc,CAAC,CAAC,4CAAvCQ,OAAO,iBAEd,gBAAuBP,UAAU,EAAE,CAA3BQ,UAAU,aAAVA,UAAU,CAClB,gBAAgCP,UAAU,EAAE,CAApCQ,OAAO,aAAPA,OAAO,CAAEC,UAAU,aAAVA,UAAU,CAC3B,cAAqBR,QAAQ,EAAE,CAAvBS,QAAQ,WAARA,QAAQ,CAEhB,cAA4Cf,QAAQ,CAAS,CAAC,CAAC,wCAAxDgB,cAAc,eAAEC,iBAAiB,eACxC,eAAwCjB,QAAQ,CAAS,CAAC,CAAC,yCAApDkB,YAAY,eAAEC,eAAe,eACpC,eAA4BnB,QAAQ,CAAS,CAAC,CAAC,yCAAxCoB,MAAM,eAAEC,SAAS,eACxB,eAA0BrB,QAAQ,CAAS,CAAC,CAAC,yCAAtCsB,KAAK,eAAEC,QAAQ,eACtB,eAAwBvB,QAAQ,CAAS,EAAE,CAAC,0CAArCwB,IAAI,gBAAEC,OAAO,gBAEpB,gBAAoCzB,QAAQ,CAAS,MAAM,CAAC,2CAArD0B,UAAU,gBAAEC,aAAa,gBAEhC,gBAA2B3B,QAAQ,CAAU,KAAK,CAAC,2CAA5C4B,MAAM,gBAAEC,QAAQ,gBAEvB,QAASC,aAAY,EAAG,CACtB,GACEd,cAAc,GAAK,CAAC,EACjBE,YAAY,GAAK,CAAC,EAClBE,MAAM,GAAK,CAAC,EACZE,KAAK,GAAK,CAAC,CACd,CACA,MAAO,MAAK,CACd,CACA,MAAO,KAAI,CACb,CAEA,GAAMS,IAAG,CAAG,QAANA,IAAG,CAAIC,CAAM,CAAK,CACtBA,CAAC,CAACC,cAAc,EAAE,CAClBJ,QAAQ,CAAC,IAAI,CAAC,CACd,GAAIC,YAAY,EAAE,CAAE,CAClBhB,UAAU,CAAC,CACToB,MAAM,CAAE,IAAI,CACZC,OAAO,CAAE,gBAAgB,CACzBC,MAAM,CAAE,gBAAgB,CACxBC,MAAM,CAAE,EACV,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,QAEaC,IAAG,qHAAlB,mJACE1B,UAAU,CAAC,IAAI,CAAC,CAAC,sBACOJ,eAAc,WACjCQ,cAAc,eAAME,YAAY,EACnCX,WAAW,CAACa,MAAM,CAAEM,UAAU,CAAC,CAC/BJ,KAAK,CACLE,IAAI,CACJb,OAAO,CAAC,cAAc,CAAC,CACxB,QANK4B,SAAS,eAOf,GAAIA,SAAS,GAAK,UAAU,CAAE,CAC5B7B,QAAQ,CAAC,cAAc,CAAC,CAC1B,CAAC,IAAM,CACLK,QAAQ,CAAC,CACPmB,MAAM,CAAE,IAAI,CACZC,OAAO,CAAE,sDACX,CAAC,CAAC,CACJ,CACAvB,UAAU,CAAC,KAAK,CAAC,CAAC,sDACnB,sCAEDX,SAAS,CAAC,UAAM,CACd,GAAIY,OAAO,CAACwB,MAAM,GAAK,SAAS,EAAIxB,OAAO,CAACuB,MAAM,GAAK,gBAAgB,CAAE,CACvEE,GAAG,EAAE,CACLxB,UAAU,CAAC,CACToB,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,EAAE,CACXC,MAAM,CAAE,EAAE,CACVC,MAAM,CAAE,EACV,CAAC,CAAC,CACJ,CACF,CAAC,CAAE,CAACxB,OAAO,CAACwB,MAAM,CAAC,CAAC,CAEpB,mBACE,aAAK,SAAS,CAAC,iCAAiC,wBAE9C,YAAK,SAAS,CAAC,6BAA6B,iBAEtC,cAEN,YAAK,SAAS,CAAC,gCAAgC,uBAC7C,aAAK,SAAS,CAAC,8BAA8B,wBAE3C,YAAK,SAAS,CAAC,qCAAqC,gCAE9C,cAEN,cAAM,QAAQ,CAAEN,GAAI,wBAElB,aAAK,SAAS,CAAC,YAAY,wBACzB,aAAK,SAAS,CAAC,aAAa,qCAE1B,aACE,SAAS,qEAELD,YAAY,EAAE,EACXd,cAAc,GAAK,CAAC,EACpBE,YAAY,GAAK,CAAC,CACrB,EAAE,CAAG,MAAM,wBAEb,eAGG,GACH,cACN,aAAK,SAAS,CAAC,YAAY,wBACzB,cACE,IAAI,CAAC,QAAQ,CACb,SAAS,CAAC,UAAU,CACpB,QAAQ,CAAE,kBAACc,CAAC,CAAK,CAAEf,iBAAiB,CAACe,CAAC,CAACQ,MAAM,CAACC,aAAa,CAAC,CAAE,CAAE,EAChE,cACF,aAAM,SAAS,CAAC,kBAAkB,eAAS,cAC3C,cACE,IAAI,CAAC,QAAQ,CACb,SAAS,CAAC,UAAU,CACpB,QAAQ,CAAE,kBAACT,CAAC,CAAK,CAAEb,eAAe,CAACa,CAAC,CAACQ,MAAM,CAACC,aAAa,CAAC,CAAE,CAAE,EAC9D,GACE,GACF,cAEN,aAAK,SAAS,CAAC,YAAY,wBACzB,aAAK,SAAS,CAAC,aAAa,iCAE1B,aAAM,SAAS,0BAAoBX,YAAY,EAAE,EAAIV,MAAM,GAAK,CAAC,CAAG,EAAE,CAAG,MAAM,CAAG,eAE3E,GACH,cACN,aAAK,SAAS,CAAC,8BAA8B,wBAC3C,cACE,IAAI,CAAC,QAAQ,CACb,IAAI,CAAC,YAAY,CACjB,SAAS,CAAC,UAAU,CACpB,QAAQ,CAAE,kBAACY,CAAC,CAAK,CAAEX,SAAS,CAACW,CAAC,CAACQ,MAAM,CAACC,aAAa,CAAC,CAAE,CAAE,EACxD,cACF,aAAK,SAAS,CAAC,mBAAmB,wBAChC,gBACE,QAAQ,CAAE,kBAACT,CAAC,CAAK,CAAEL,aAAa,CAACK,CAAC,CAACQ,MAAM,CAACE,KAAK,CAAC,CAAE,CAAE,wBAEpD,eAAQ,KAAK,CAAC,MAAM,kBAAc,cAClC,eAAQ,KAAK,CAAC,MAAM,kBAAc,GAC3B,cACT,aAAM,SAAS,CAAC,cAAc,EAAG,GAC7B,GACF,GACF,cAEN,aAAK,SAAS,CAAC,YAAY,wBACzB,aAAK,SAAS,CAAC,aAAa,gCAE1B,aAAM,SAAS,0BAAoBZ,YAAY,EAAE,EAAIR,KAAK,GAAK,CAAC,CAAG,EAAE,CAAG,MAAM,CAAG,eAE1E,GACH,cACN,cACE,IAAI,CAAC,QAAQ,CACb,IAAI,CAAC,OAAO,CACZ,SAAS,CAAC,UAAU,CACpB,QAAQ,CAAE,kBAACU,CAAC,CAAK,CAAET,QAAQ,CAACS,CAAC,CAACQ,MAAM,CAACC,aAAa,CAAC,CAAE,CAAE,EACvD,GACE,cAEN,aAAK,SAAS,CAAC,YAAY,wBACzB,YAAK,SAAS,CAAC,aAAa,kBAAW,cACvC,iBACE,IAAI,CAAE,CAAE,CACR,SAAS,CAAC,eAAe,CACzB,QAAQ,CAAE,kBAACT,CAAC,CAAK,CAAEP,OAAO,CAACO,CAAC,CAACQ,MAAM,CAACE,KAAK,CAAC,CAAE,CAAE,EAC9C,GACE,cAEN,YAAK,SAAS,mCAA6BZ,YAAY,EAAE,EAAI,CAACF,MAAM,CAAG,EAAE,CAAG,MAAM,CAAG,qCAE/E,cAEN,cACE,SAAS,CAAC,6BAA6B,CACvC,IAAI,CAAC,QAAQ,CACb,KAAK,CAAC,SAAS,EACf,GACG,GACH,EACF,GACF,CAEV"},"metadata":{},"sourceType":"module"}